/*!
 * morsio.js
 * ---------
 * Library for parsing and sounding morse tones
 *
 * @version 0.2.7 (2014/08/22)
 * @license MIT
 * @author mach3 <http://github.com/mach3>
 * @require jquery#1
 */
!function(a,b){var c={};b.AudioContext=b.AudioContext||b.webkitAudioContext,b.AudioContext.prototype.createGain=b.AudioContext.prototype.createGain||b.AudioContext.prototype.createGainNode,c.utils={getKeyByValue:function(a,b){var c=null;for(i in b)if(b.hasOwnProperty(i)&&b[i]===a){c=i;break}return c},delegate:function(a,b){b.forEach(function(b){a[b]=a[b].bind(a)})},roundIndex:function(a,b){var c=[];return b.forEach(function(b,d){c[d]=Math.abs(a-b)}),c.indexOf(Math.min.apply(null,c))},combine:function(a,b){var c=[];return a.forEach(function(a,d){c[a]=b[d]}),c},config:function(){var b=arguments;switch(this.options=this.options||{},a.type(b[0])){case"string":return b.length<2?this.options[b[0]]:(this.options[b[0]]=b[1],this);case"object":return this.options=a.extend(!0,{},this.options,b[0]),this;case"undefined":return this.options}return this}};var d=c.Composer=function(){this._construct.apply(this,arguments)};!function(){var b=d.prototype,e=c.utils;b.defaults={mode:"alpha",time:100,process:a.noop,complete:a.noop},b.options=null,b.tones=null,b._tones=null,b.playing=!1,b.timer=null,b.regMode=/^([a-z]+)\:/,b._construct=function(a){this.config(this.defaults).config(a),this.process=this.process.bind(this)},b.config=function(){return e.config.apply(this,arguments)},b.validate=function(b,d){var e,f,g;return d=d||" ",e=[],f=this.map(),g=c.validation[this.config("mode")]||{},f?(b.toLowerCase().split("").forEach(function(b){var c,h;return c=b.charCodeAt(0),c in f?void e.push(b):c in g?(h=g[c],h=a.isArray(h)?h:[h],void h.forEach(function(a){e.push(String.fromCharCode(a))})):void e.push(d)}),e.join("")):b},b.parse=function(a){var b,c,d;return b=this,c=this.map(),d=[],this.validate(a).toLowerCase().split("").forEach(function(a){var b=c[a.charCodeAt(0)]||".";d.push(b)}),this.tones=d.join("."),this},b.map=function(b){var d,e={};return d=c.map,b=b||this.config("mode"),a.extend(e,d.symbol,d.num,d[b]),e},b.play=function(a){return this.playing||(this.playing=!0,a=a||this.tones,this._tones=this.parseTones(a),this.process()),this},b.parseTones=function(a){var b=[];return!!a&&a.replace(this.regMode,"").split("").forEach(function(a){return(a=parseInt(a,10))?(b.push([!0,a]),void b.push([!1,1])):b.push([!1,3])}),b},b.stop=function(){this.playing=!1,clearTimeout(this.timer)},b.process=function(){var a,b=this.options;if(this.playing)return a=this._tones.shift(),a&&b.process.apply(this,a),this._tones.length?void(this.timer=setTimeout(this.process,a[1]*b.time)):(b.complete(),void(this.playing=!1))},b.translate=function(a){var b,c,d;return a=a||this.tones||"",b=this,c=function(){var c=a.match(b.regMode);return a=a.replace(b.regMode,""),b.map(c?c[1]:null)}(),d=[],a.split(".").forEach(function(a){var b=e.getKeyByValue(a,c)||"32";d.push(String.fromCharCode(b))}),d.join("")},b.clear=function(){this.tones=null,this._tones=null},b.load=function(a){var b=this;return/^([\w]+:)?[\d\.]+$/.test(a)?(this.config("mode",function(){var c=a.match(b.regMode);return c?c[1]:b.config("mode")}()),this.tones=a.replace(b.regMode,""),this):!1}}();var e=c.Tone=function(){this._construct.apply(this,arguments)};!function(){var b=e.prototype,d=c.utils;b.touchable=void 0!==window.ontouchstart,b.doc=null,b.context=null,b.osc=null,b.gain=null,b._construct=function(){return d.delegate(this,["onFirstTouch"]),this.doc=a(document),this.context=new AudioContext,this.osc=this.context.createOscillator(),this.gain=this.context.createGain(),this.gain.gain.value=0,this.osc.connect(this.gain),this.gain.connect(this.context.destination),this.touchable?this.doc.on("touchstart",this.onFirstTouch):void this.osc.start(0)},b.onFirstTouch=function(){this.osc.start(0),this.doc.off("touchstart",this.onFirstTouch)},b.toggle=function(a){return this.gain.gain.value=a?1:0,this},b.on=function(){return this.toggle(!0)},b.off=function(){return this.toggle(!1)}}();var f=c.Recorder=function(){this._construct.apply(this,arguments)};!function(){var a=f.prototype,b=c.utils;a.defaults={mode:"alpha"},a.options=null,a.source=[],a.tones=null,a.recording=!1,a._construct=function(a){this.config(this.defaults).config(a)},a.config=function(){return b.config.apply(this,arguments)},a.start=function(){this.recording||(this.source=[],this.recording=!0)},a.stop=function(){this.recording&&(this.recording=!1,this.parse())},a.tone=function(a){this.recording&&this.source.push([a,(new Date).getTime()])},a.clear=function(){this.source=[],this.tones=null},a.parse=function(){var a,c,d,e,f;return a=this.source,c=[],d=null,a.forEach(function(b,e){var f,g;return f=a[e+1],void 0===f?c.push([!1,0]):(g=f[1]-b[1],c.push([b[0],g]),void(d=d?Math.min(d,g):g))}),e=[d,3*d],f=[],c.forEach(function(a,d){a[1]=b.roundIndex(a[1],e)?3:1;var g=c[d-1];return!a[0]&&(f.push(g[1]),a[1]>1)?f.push("."):void 0}),this.tones=f.join(""),this.tones}}(),b.morsio=c}(jQuery,this),function(a,b){var c=b.morsio=b.morsio||{};c.map={kana:{48:"33333",49:"13333",50:"11333",51:"11133",52:"11113",53:"11111",54:"31111",55:"33111",56:"33311",57:"33331",12289:"131313",12301:"131311",12443:"11",12444:"11331",12450:"33133",12452:"13",12454:"113",12456:"31333",12458:"13111",12459:"1311",12461:"31311",12463:"1113",12465:"3133",12467:"3333",12469:"31313",12471:"33131",12473:"33313",12475:"13331",12477:"3331",12479:"31",12481:"1131",12484:"1331",12486:"13133",12488:"11311",12490:"131",12491:"3131",12492:"1111",12493:"3313",12494:"1133",12495:"3111",12498:"33113",12501:"3311",12504:"1",12507:"311",12510:"3113",12511:"11313",12512:"3",12513:"31113",12514:"31131",12516:"133",12518:"31133",12520:"33",12521:"111",12522:"331",12523:"31331",12524:"333",12525:"1313",12527:"313",12528:"13113",12529:"13311",12530:"1333",12531:"13131",12540:"13313",65288:"313313",65289:"131131"},alpha:{33:"313133",40:"31331",41:"313313",44:"331133",45:"311113",46:"131313",47:"31131",48:"33333",49:"13333",50:"11333",51:"11133",52:"11113",53:"11111",54:"31111",55:"33111",56:"33311",57:"33331",63:"113311",64:"133131",97:"13",98:"3111",99:"3131",100:"311",101:"1",102:"1131",103:"331",104:"1111",105:"11",106:"1333",107:"313",108:"1311",109:"33",110:"31",111:"333",112:"1331",113:"3313",114:"131",115:"111",116:"3",117:"113",118:"1113",119:"133",120:"3113",121:"3133",122:"3311","72,72":"11111111"}}}(jQuery,this),function(a,b){var c=b.morsio=b.morsio||{};c.validation={kana:{12353:["12450"],12354:["12450"],12355:["12452"],12356:["12452"],12357:["12454"],12358:["12454"],12359:["12456"],12360:["12456"],12361:["12458"],12362:["12458"],12363:["12459"],12364:["12459","12443"],12365:["12461"],12366:["12461","12443"],12367:["12463"],12368:["12463","12443"],12369:["12465"],12370:["12465","12443"],12371:["12467"],12372:["12467","12443"],12373:["12469"],12374:["12469","12443"],12375:["12471"],12376:["12471","12443"],12377:["12473"],12378:["12473","12443"],12379:["12475"],12380:["12475","12443"],12381:["12477"],12382:["12477","12443"],12383:["12479"],12384:["12479","12443"],12385:["12481"],12386:["12481","12443"],12387:["12484"],12388:["12484"],12389:["12484","12443"],12390:["12486"],12391:["12486","12443"],12392:["12488"],12393:["12488","12443"],12394:["12490"],12395:["12491"],12396:["12492"],12397:["12493"],12398:["12494"],12399:["12495"],12400:["12495","12443"],12401:["12495","12444"],12402:["12498"],12403:["12498","12443"],12404:["12498","12444"],12405:["12501"],12406:["12501","12443"],12407:["12501","12444"],12408:["12504"],12409:["12504","12443"],12410:["12504","12444"],12411:["12507"],12412:["12507","12443"],12413:["12507","12444"],12414:["12510"],12415:["12511"],12416:["12512"],12417:["12513"],12418:["12514"],12420:["12516"],12422:["12518"],12424:["12520"],12425:["12521"],12426:["12522"],12427:["12523"],12428:["12524"],12429:["12525"],12431:["12527"],12432:["12528"],12433:["12529"],12434:["12530"],12435:["12531"],12449:["12450"],12451:["12452"],12453:["12454"],12455:["12456"],12457:["12458"],12460:["12459","12443"],12462:["12461","12443"],12464:["12463","12443"],12466:["12465","12443"],12468:["12467","12443"],12470:["12469","12443"],12472:["12471","12443"],12474:["12473","12443"],12476:["12475","12443"],12478:["12477","12443"],12480:["12479","12443"],12482:["12481","12443"],12483:["12484"],12485:["12484","12443"],12487:["12486","12443"],12489:["12488","12443"],12496:["12495","12443"],12497:["12495","12444"],12499:["12498","12443"],12500:["12498","12444"],12502:["12501","12443"],12503:["12501","12444"],12505:["12504","12443"],12506:["12504","12444"],12508:["12507","12443"],12509:["12507","12444"],12532:["12454","12443"]}}}(jQuery,this);